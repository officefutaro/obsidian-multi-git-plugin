# 🛠️ Obsidian Multi Git Manager - 開発者向けインストール・更新ガイド

## 📋 概要

このガイドは、**開発チーム**および**ベータテスター**向けのObsidian Multi Git Managerプラグインのインストール・更新手順です。プライベートGiteaサーバーからの自動インストールスクリプトを使用した効率的な管理方法を説明します。

---

## 🎯 対象者

- **開発チーム**: プラグイン開発に関わるメンバー
- **ベータテスター**: 内部テストを行うメンバー
- **技術サポート**: ユーザーサポートを行うメンバー

---

## 📦 インストール方法

### 🚀 方法1: 自動インストールスクリプト（推奨）

#### Windows環境

```powershell
# PowerShellを開いて実行（管理者権限不要）
irm "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/obsidian-multi-git-plugin/install.ps1" | iex
```

**詳細手順**:
1. **PowerShell を開く** (Windows + R → `powershell`)
2. **上記コマンドをコピー＆ペースト**
3. **Enterキーで実行**
4. **画面の指示に従ってVaultを選択**
5. **完了後、Obsidianを再起動**

#### macOS環境

```bash
# ターミナルを開いて実行
curl -sSL "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/obsidian-multi-git-plugin/install.sh" | bash
```

**詳細手順**:
1. **ターミナル を開く** (Cmd + Space → `terminal`)
2. **上記コマンドをコピー＆ペースト**
3. **Enterキーで実行**
4. **画面の指示に従ってVaultを選択**
5. **完了後、Obsidianを再起動**

#### Linux環境

```bash
# ターミナルを開いて実行
curl -sSL "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/obsidian-multi-git-plugin/install.sh" | bash
```

または `wget` を使用:

```bash
wget -qO- http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/install.sh | bash
```

### 📋 方法2: 手動スクリプト実行

セキュリティ上の理由でスクリプトを事前確認したい場合:

#### Windows
```powershell
# 1. スクリプトをダウンロード
Invoke-WebRequest -Uri "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/install.ps1" -OutFile "$env:TEMP\install-mgm.ps1"

# 2. スクリプト内容を確認（オプション）
Get-Content "$env:TEMP\install-mgm.ps1"

# 3. 実行
powershell -ExecutionPolicy Bypass -File "$env:TEMP\install-mgm.ps1"
```

#### macOS/Linux
```bash
# 1. スクリプトをダウンロード
curl -o install-mgm.sh http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/install.sh

# 2. スクリプト内容を確認（オプション）
cat install-mgm.sh

# 3. 実行権限を付与して実行
chmod +x install-mgm.sh && ./install-mgm.sh
```

---

## 🔄 プラグイン更新方法

### 🚀 方法1: 自動更新（推奨）

**既存のプラグインがインストール済みの場合、同じインストールスクリプトを実行するだけで更新されます。**

#### Windows
```powershell
# 更新用ワンライナー（インストールと同じコマンド）
irm "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/obsidian-multi-git-plugin/install.ps1" | iex
```

#### macOS/Linux
```bash
# 更新用ワンライナー（インストールと同じコマンド）
curl -sSL "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/obsidian-multi-git-plugin/install.sh" | bash
```

**更新プロセス**:
1. **最新バージョンを自動取得**
2. **既存ファイルの上書き確認**
3. **新しいファイルで上書き**
4. **Obsidian再起動の案内**

### 📋 方法2: 手動更新

#### Git経由（開発者向け）

```bash
# 1. リポジトリをクローン（初回のみ）
git clone http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin.git

# 2. 最新コードを取得
cd obsidian-multi-git-plugin
git pull origin master

# 3. 依存関係をインストール
npm install

# 4. ビルド
npm run build

# 5. Obsidianプラグインフォルダにコピー
cp main.js manifest.json styles.css "$HOME/.config/obsidian/[VAULT]/.obsidian/plugins/multi-git-manager/"
```

#### 手動ファイル更新

1. **Giteaから最新ファイルをダウンロード**:
   - http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/main.js
   - http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/manifest.json
   - http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/styles.css

2. **既存ファイルを上書き**:
   ```
   [VAULT]/.obsidian/plugins/multi-git-manager/
   ├── main.js       ← 上書き
   ├── manifest.json ← 上書き
   └── styles.css    ← 上書き
   ```

3. **Obsidianを再起動**

---

## 🎛️ バージョン管理

### 📊 バージョン確認

#### Obsidian内で確認
1. **設定 → コミュニティプラグイン**
2. **「Multi Git Manager」の情報を確認**
3. **バージョン番号とリリース日を確認**

#### コマンドライン確認
```bash
# manifest.jsonからバージョンを確認
cat "[VAULT]/.obsidian/plugins/multi-git-manager/manifest.json" | grep version
```

### 🏷️ 開発ブランチへの切り替え

**開発中の最新機能をテストしたい場合**:

```bash
# developブランチのインストール（Windows）
$url = "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/develop/install.ps1"
irm $url | iex

# developブランチのインストール（macOS/Linux）
curl -sSL http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/develop/install.sh | bash
```

### 📈 リリース履歴の確認

**Gitea リリースページ**:
```
http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/releases
```

**コマンドライン確認**:
```bash
# リリース一覧を取得
curl -s http://192.168.68.72:3000/api/v1/repos/futaro/obsidian-multi-git-plugin/releases | grep tag_name
```

---

## 🔧 開発環境セットアップ

### 📦 完全な開発環境構築

```bash
# 1. リポジトリをクローン
git clone http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin.git
cd obsidian-multi-git-plugin

# 2. 依存関係をインストール
npm install

# 3. 開発用ビルド（ファイル監視）
npm run dev

# 4. テスト実行
npm test

# 5. カバレッジ確認
npm run test:coverage

# 6. プロダクションビルド
npm run build
```

### 🔗 シンボリックリンク設定（上級者向け）

**開発中のリアルタイム更新に便利**:

#### Windows
```powershell
# 管理者権限でPowerShellを開く
$source = "D:\Project\2510_obsidianGit\obsidian-multi-git-plugin"
$target = "$env:APPDATA\obsidian\[VAULT]\.obsidian\plugins\multi-git-manager"
New-Item -ItemType SymbolicLink -Path $target -Target $source
```

#### macOS/Linux
```bash
# シンボリックリンク作成
ln -s /path/to/obsidian-multi-git-plugin ~/.config/obsidian/[VAULT]/.obsidian/plugins/multi-git-manager
```

---

## 🛠️ トラブルシューティング

### ❌ よくある問題と解決方法

#### 1. スクリプト実行エラー

**Windows: PowerShell実行ポリシーエラー**
```powershell
# 実行ポリシーを一時的に変更
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

# または実行時に指定
powershell -ExecutionPolicy Bypass -Command "irm "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/obsidian-multi-git-plugin/install.ps1" | iex"
```

**macOS/Linux: 権限エラー**
```bash
# 実行権限を明示的に付与
chmod +x install.sh
./install.sh
```

#### 2. ネットワーク接続エラー

**Giteaサーバーにアクセスできない場合**:
```bash
# 接続テスト
ping 192.168.68.72

# HTTPアクセステスト
curl -I http://192.168.68.72:3000

# DNS確認（必要に応じて）
nslookup 192.168.68.72
```

**解決方法**:
- ネットワーク接続を確認
- ファイアウォール設定を確認
- VPN接続が必要な場合は接続
- Giteaサーバーの稼働状況を確認

#### 3. プラグインが認識されない

**インストール後にプラグインが表示されない場合**:

1. **ファイル配置確認**:
   ```bash
   # ファイル存在確認
   ls -la "[VAULT]/.obsidian/plugins/multi-git-manager/"
   # 以下の3ファイルが存在することを確認:
   # main.js, manifest.json, styles.css
   ```

2. **ファイルサイズ確認**:
   ```bash
   # ファイルサイズが0でないことを確認
   ls -lh "[VAULT]/.obsidian/plugins/multi-git-manager/"
   ```

3. **権限確認**:
   ```bash
   # ファイルが読み取り可能であることを確認
   chmod 644 "[VAULT]/.obsidian/plugins/multi-git-manager/"*
   ```

#### 4. 古いバージョンが残っている

**キャッシュクリア**:
```bash
# Obsidianキャッシュディレクトリをクリア（Obsidian終了後）
rm -rf "[VAULT]/.obsidian/app.json"
rm -rf "[VAULT]/.obsidian/workspace"
```

**完全再インストール**:
```bash
# 既存プラグインを完全削除
rm -rf "[VAULT]/.obsidian/plugins/multi-git-manager"

# 再インストール実行
curl -sSL "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/obsidian-multi-git-plugin/install.sh" | bash
```

### 🔍 デバッグ方法

#### 1. Obsidian開発者ツール

```javascript
// Obsidianで開発者ツールを開く: Ctrl+Shift+I (Windows/Linux) / Cmd+Option+I (macOS)

// プラグインの読み込み状況を確認
console.log(app.plugins.plugins['multi-git-manager']);

// エラーログを確認
console.log(app.plugins.manifests['multi-git-manager']);
```

#### 2. ログファイル確認

**Obsidianログファイルの場所**:
- **Windows**: `%APPDATA%\obsidian\logs\`
- **macOS**: `~/Library/Logs/obsidian/`
- **Linux**: `~/.config/obsidian/logs/`

#### 3. プラグインのリロード

```javascript
// 開発者ツールで実行
// プラグインを無効化
await app.plugins.disablePlugin('multi-git-manager');

// プラグインを有効化
await app.plugins.enablePlugin('multi-git-manager');
```

---

## 📊 品質管理

### 🧪 テスト実行

```bash
# ユニットテスト
npm test

# カバレッジレポート
npm run test:coverage

# E2Eテスト
npm run test:e2e

# AI評価テスト
npm run test:ai
```

### 📈 パフォーマンス監視

```javascript
// Obsidian内でパフォーマンス測定
console.time('plugin-load');
// プラグイン操作
console.timeEnd('plugin-load');

// メモリ使用量確認
console.log(performance.memory);
```

### 🔍 セキュリティチェック

```bash
# 依存関係の脆弱性チェック
npm audit

# 修正可能な脆弱性の自動修正
npm audit fix
```

---

## 📞 サポート・フィードバック

### 🐛 バグ報告

**Gitea Issues**:
```
http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/issues
```

**報告テンプレート**:
```markdown
## 環境情報
- OS: Windows/macOS/Linux
- Obsidianバージョン: 
- プラグインバージョン: 
- インストール方法: 自動スクリプト/手動

## 問題の詳細
[詳細な説明]

## 再現手順
1. 
2. 
3. 

## 期待される動作
[説明]

## 実際の動作
[説明]

## ログ・エラーメッセージ
```
[開発者ツールのConsoleタブからコピー]
```

## 追加情報
[その他関連する情報]
```

### 💡 機能要望

**Discussions**:
```
http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/discussions
```

### 📧 直接連絡

- **開発チーム**: [開発チームのメールアドレス]
- **技術サポート**: [サポートのメールアドレス]

---

## 🔄 継続的更新

### 📅 更新スケジュール

- **緊急バグ修正**: 即座にリリース
- **定期更新**: 月2回（第2・第4木曜日）
- **メジャーアップデート**: 四半期ごと
- **セキュリティアップデート**: 発見次第即座

### 🔔 更新通知

1. **Gitea Notifications**: リポジトリをWatchして通知受信
2. **メール通知**: 開発チームメーリングリストへの参加
3. **チャット通知**: Slack/Discordチャンネルでの案内

### 📋 更新前チェックリスト

- [ ] 重要なデータのバックアップ
- [ ] 現在のプラグインバージョンの記録
- [ ] Obsidianの終了
- [ ] 更新スクリプトの実行
- [ ] Obsidianの再起動
- [ ] 基本機能の動作確認
- [ ] 問題があれば即座に報告

---

## 🎓 高度な使用方法

### 🔧 カスタム設定

```javascript
// Obsidian開発者ツールで設定変更
const plugin = app.plugins.plugins['multi-git-manager'];
plugin.settings.updateInterval = 60000; // 60秒間隔に変更
await plugin.saveSettings();
```

### 🎨 スタイルカスタマイズ

```css
/* Obsidian CSS snippetsでカスタマイズ */
.git-manager-view {
    font-family: 'JetBrains Mono', monospace;
}

.git-status-modified {
    color: #ff9500 !important;
}
```

### 🤖 自動化スクリプト

```bash
#!/bin/bash
# 定期的な自動更新スクリプト

echo "Multi Git Manager Auto-Update"
curl -sSL "http://192.168.68.72:3000/futaro/obsidian-multi-git-plugin/raw/branch/master/obsidian-multi-git-plugin/install.sh" | bash

# Obsidianが起動中の場合は再起動を促す通知
if pgrep -x "obsidian" > /dev/null; then
    echo "Obsidianを再起動してください"
fi
```

---

## 📖 関連ドキュメント

### 📚 技術ドキュメント

- **[技術アーキテクチャ](../TECHNICAL-ARCHITECTURE.md)**: プラグインの内部構造
- **[API仕様](../api-specs/)**: 詳細なAPI仕様
- **[テスト戦略](../TESTING-GUIDE.md)**: テストの実行方法

### 👥 ユーザー向けドキュメント

- **[ユーザーガイド](../../obsidian-multi-git-plugin/USER-GUIDE.md)**: 詳細な使用方法
- **[クイックスタート](../../obsidian-multi-git-plugin/QUICK-START.md)**: 5分で始める方法
- **[FAQ](../../obsidian-multi-git-plugin/FAQ.md)**: よくある質問

---

**🎉 効率的なプラグイン開発・管理で、Obsidianをさらに便利に活用しましょう！**

---

*このドキュメントは Multi Git Manager v1.0.0+ 向けです*  
*最終更新: 2024年10月26日*